CRI-Reference = [
  (authority // discard),
  *path,
  ? (([], fragment)              ; include array only if
     //([+query], ?fragment))    ; at least one query and/or fragment
]

authority   = (?scheme, ?(host, ?port))
scheme      = (scheme-name
               // COAP // COAPS // HTTP // HTTPS)
scheme-name = (false, text .regexp "[a-z][a-z0-9+.-]*")
COAP = -1 COAPS = -2 HTTP = -3 HTTPS = -4
host        = (host-name // host-ip)
host-name   = (true, text)
host-ip     = bytes .size 4 / bytes .size 16
port        = 0..65535
discard     = 0..127
path        = text
query       = text
fragment    = text
